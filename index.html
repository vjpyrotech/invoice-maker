<html lang="en"><head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accounting Voucher Display</title>
<style>
    body {
        font-family: "Arial", sans-serif; /* Unified font for all */
        background-color: #fff;
        margin: 20px;
    }
    
    .invoice-container {
        width: 681px; /* Exact width from original */
        margin: 0 auto;
    }

    .title {
        text-align: center;
        /* font-family removed (inherited) */
        font-weight: bold;
        font-size: 10pt;
        margin-bottom: 5px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
    }

    td {
        padding: 2px 4px;
        vertical-align: top;
        font-size: 11pt;
        color: black;
        line-height: normal;
    }

    /* Column Widths (matching original pixel counts) */
    .col-1 { width: 38px; }
    .col-2 { width: 246px; }
    .col-3 { width: 38px; }
    .col-4 { width: 38px; }
    .col-5 { width: 47px; }
    .col-6 { width: 57px; }
    .col-7 { width: 57px; }
    .col-8 { width: 66px; }
    .col-9 { width: 95px; }

    /* Typography Utilities */
    .font-arial { /* font-family removed (inherited) */ }
    .bold { font-weight: bold; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .text-justify { text-align: justify; }
    .size-14 { font-size: 14pt; }
    .size-12 { font-size: 12pt; }
    .size-11 { font-size: 11pt; }
    .size-10 { font-size: 10pt; }
    .size-8 { font-size: 8pt; }

    /* Borders Utilities */
    .b-top { border-top: 1px solid black; }
    .b-bottom { border-bottom: 1px solid black; }
    .b-left { border-left: 1px solid black; }
    .b-right { border-right: 1px solid black; }
    .b-all { border: 1px solid black; }
    
    .no-b-top { border-top: none; }
    .no-b-bottom { border-bottom: none; }
    .no-b-left { border-left: none; }
    .no-b-right { border-right: none; }
    .no-b-all { border: none; }
    
    /* Layout heights */
    .h-sm { height: 14pt; }
    .h-md { height: 36pt; }
    .h-lg { height: 52pt; }

    /* UI for Editing and Printing */
    .no-print {
        position: sticky; /* Make button sticky */
        top: 10px;
        z-index: 1000;
        margin-bottom: 20px;
        padding: 10px 20px;
        background-color: #4CAF50;
        color: white;
        border: none;
        cursor: pointer;
        font-size: 16px;
        border-radius: 4px;
        display: block;
        margin-left: auto;
        margin-right: auto;
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    .no-print:hover {
        background-color: #45a049;
    }
    
    [contenteditable="true"] {
        transition: background-color 0.2s;
        min-width: 20px;
    }

    [contenteditable="true"]:hover {
        background-color: #fffec8; /* Light yellow hint */
        cursor: text;
        outline: 1px dashed #ccc;
    }
    
    [contenteditable="true"]:focus {
        background-color: #fff;
        outline: 2px solid #4CAF50;
        z-index: 10;
        position: relative;
    }

    /* Action Buttons */
    .delete-row-btn {
        position: absolute;
        left: -32px;
        top: 50%;
        transform: translateY(-50%);
        width: 22px;
        height: 22px;
        line-height: 22px;
        text-align: center;
        color: white;
        background-color: #ff4444;
        border-radius: 50%;
        cursor: pointer;
        font-weight: bold;
        font-size: 14px;
        user-select: none;
        opacity: 0;
        transition: opacity 0.2s, transform 0.1s;
        z-index: 5;
    }

    .item-row:hover .delete-row-btn {
        opacity: 1;
    }

    .delete-row-btn:hover {
        transform: translateY(-50%) scale(1.1);
        background-color: #cc0000;
    }

    .add-row-container td {
        text-align: center;
        padding: 10px 0;
        border: none;
    }

    .add-row-btn {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 6px 16px;
        border-radius: 15px;
        cursor: pointer;
        font-size: 13px;
        font-weight: bold;
        transition: background-color 0.2s;
        display: inline-block;
    }

    .add-row-btn:hover {
        background-color: #45a049;
    }

    /* Mobile Responsive Styles */
    @media screen and (max-width: 720px) {
        body {
            margin: 10px;
        }
        .invoice-container {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
            padding-bottom: 20px; /* Space for scrollbar */
            padding-left: 35px; /* Space for delete button */
            box-sizing: border-box;
        }
        table {
            min-width: 681px; /* Force table to keep its shape */
        }
        .delete-row-btn {
            opacity: 1; /* Always visible on mobile */
        }
    }

    @media print {
        @page { margin: 0; }
        .no-print, .delete-row-btn, .add-row-container { display: none !important; }
        [contenteditable="true"] {
            background-color: transparent !important;
            outline: none !important;
        }
        body { 
            margin: 1cm 0 !important; /* Top/Bottom margin since page margin is 0 */
            background-color: white !important;
            -webkit-print-color-adjust: exact; 
        }
        .invoice-container { 
            width: 681px !important; /* Strict width for print */
            margin: 0 auto !important;
            overflow: visible !important;
            padding: 0 !important;
        }
        table {
            width: 100% !important;
            min-width: 681px !important;
        }
        /* Ensure layout heights don't break across pages awkwardly if possible */
        tr { page-break-inside: avoid; }
    }
</style>
</head>
<body>

<button class="no-print" onclick="window.print()">Print Invoice</button>

<div class="invoice-container">
    <div class="title">INVOICE</div>

    <table>
        <colgroup>
            <col class="col-1">
            <col class="col-2">
            <col class="col-3">
            <col class="col-4">
            <col class="col-5">
            <col class="col-6">
            <col class="col-7">
            <col class="col-8">
            <col class="col-9">
        </colgroup>

        <tbody>
            <!-- Header Row 1 -->
            <tr class="h-sm">
                <td colspan="3" rowspan="4" class="b-all text-justify">
                    <div contenteditable="true">
                        <div class="bold size-14">VJ Traders</div>
                        <div class="font-arial">No 1 A, Red hills Road,</div>
                        <div class="font-arial">Chennai-600053</div>
                        <div class="font-arial">State: Tamil Nadu</div>
                        <div class="font-arial">MOB 9940651702</div>
                        <div>GSTIN 33AJBPV5929R1ZE</div>
                    </div>
                </td>
                <td colspan="4" class="b-left ">
                    <div class="font-arial size-11">Invoice No.</div>
                    <div contenteditable="true" id="invoice-no"></div>
                </td>
                <td colspan="2" class="">
                    <div class="font-arial size-11">Dated</div>
                    <div class="font-arial bold" contenteditable="true" id="invoice-date"></div>
                </td>
            </tr>

            <!-- Header Row 2 -->
            <tr class="h-sm">
                <td colspan="4" class="b-left no-b-top">
                    <div class="font-arial">Delivery Note</div>
                    <div contenteditable="true" class="size-10">&nbsp;</div>
                </td>
                <td colspan="2" class=" no-b-top">
                    <div class="font-arial">Mode/Terms of Payment</div>
                    <div contenteditable="true" class="size-10">&nbsp;</div>
                </td>
            </tr>

            <!-- Header Row 3 -->
            <tr>
                <td colspan="4" class="b-left no-b-top no-b-bottom">&nbsp;</td>
                <td colspan="2" class="no-b-top no-b-bottom">&nbsp;</td>
            </tr>

            <!-- Header Row 4 -->
            <tr>
                <td colspan="4" class="b-left no-b-top no-b-bottom">&nbsp;</td>
                <td colspan="2" class=" no-b-top no-b-bottom">&nbsp;</td>
            </tr>

            <!-- Consignee Section -->
            <tr>
                <td colspan="3" rowspan="4" class="b-all no-b-top">
                    <div class="font-arial bold size-12" style="margin-bottom: 4px;">Consignee (Ship to)</div>
                    <div contenteditable="true">
                        <div>Olive Events</div>
                        <div class="spell-e">Payyannur</div>
                        <div>KERALA</div>
                        <div class="font-arial size-10">MOB : 8848576103</div>
                    </div>
                </td>
                <td colspan="6" class="no-b-all">&nbsp;</td>
            </tr>
            <tr><td colspan="6" class="no-b-all">&nbsp;</td></tr>
            <tr><td colspan="6" class="no-b-all">&nbsp;</td></tr>
            <tr><td colspan="6" class="no-b-all">&nbsp;</td></tr>

            <!-- Buyer Section -->
            <tr class="h-lg">
                <td colspan="3" class="b-left b-bottom b-right no-b-top">
                    <div class="font-arial bold size-12" style="margin-bottom: 4px;">Buyer (Bill to)</div>
                    <div contenteditable="true">
                        <div>Olive Events</div>
                        <div class="spell-e">Payyannur</div>
                        <div>KERALA</div>
                        <div class="font-arial size-10">MOB : 8848576103</div>
                    </div>
                </td>
                <td colspan="6" class="b-bottom no-b-top no-b-left no-b-right">&nbsp;</td>
            </tr>

            <!-- Items Header -->
            <tr>
                <td class="b-left b-bottom b-right size-8 font-arial">SL</td>
                <td class="b-bottom b-right size-10 font-arial text-center" style="padding-left: 32px; text-align: left;">Description of Goods</td>
                <td colspan="2" class="b-bottom b-right text-center size-10">GST / IGST</td>
                <td class="b-bottom b-right text-center size-10">%</td>
                <td class="b-bottom b-right text-center font-arial size-10">Quantity</td>
                <td class="b-bottom b-right text-center font-arial size-10">Rate</td>
                <td class="b-bottom b-right text-center font-arial size-10">per</td>
                <td class="b-bottom b-right text-center font-arial size-10">Amount</td>
            </tr>

            <!-- Item Row 1 -->
            <tr class="h-md item-row">
                <td class="b-left b-right font-arial size-8" style="position: relative; overflow: visible;">
                    <span class="sl-no" contenteditable="true">1</span>
                    <span class="delete-row-btn" onclick="deleteRow(this)" title="Delete Row">&times;</span>
                </td>
                <td class="b-right">
                    <div class="size-11" contenteditable="true">Carnival entertainment article(DÃ‰COR)</div>
                </td>
                <td colspan="2" class="b-right text-center size-10" contenteditable="true">95051000</td>
                <td class="b-right text-center size-10 tax-per" contenteditable="true" oninput="calculate()">18</td>
                <td class="b-right size-10">
                    <div class="text-right qty" style="padding-right: 5px;" contenteditable="true" oninput="calculate()">1</div>
                </td>
                <td class="b-right text-center size-10 rate" contenteditable="true" oninput="calculate()">2500</td>
                <td class="b-right text-center size-10" contenteditable="true">BOX</td>
                <td class="b-right text-center size-10 amount">2500.00</td>
            </tr>

            <!-- Add Row Button Row -->
            <tr class="add-row-container" id="add-row-container">
                <td colspan="9">
                     <button class="add-row-btn" onclick="addRow()" title="Add Row">+ Add Row</button>
                </td>
            </tr>

            <!-- Tax Row -->
            <tr style="height: 19.8pt;">
                <td class="b-left b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom text-right">
                    <span style="margin-right: 8px;">GST/IGST</span>
                </td>
                <td colspan="2" class="b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom">&nbsp;</td>
                <td class="b-right no-b-top no-b-bottom text-center size-10" id="total-tax-amt">450.00</td>
            </tr>

            <!-- Spacer Row -->
            <tr style="height: 23.95pt;">
                <td class="b-left b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
                <td colspan="2" class="b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
                <td class="b-right b-bottom no-b-top">&nbsp;</td>
            </tr>

            <!-- Total Row -->
            <tr>
                <td class="b-all no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top text-right font-arial size-10">Total</td>
                <td colspan="2" class="b-bottom b-right no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top">&nbsp;</td>
                <td class="b-bottom b-right no-b-top text-right size-10" style="padding-right: 9pt;" id="grand-total">2950.00</td>
            </tr>

            <!-- Amount in Words -->
            <tr>
                <td colspan="9" class="b-left b-bottom b-right">
                    <div class="font-arial size-10" style="margin-bottom: 4px;">
                        Amount Chargeable (in words)
                    </div>
                    <div class="size-11 bold" id="amount-words">
                        INR TWO THOUSAND NINE HUNDRED & FIFTY ONLY
                    </div>
                </td>
            </tr>

            <!-- Spacer Row -->
            <tr style="height: 23.35pt;">
                <td colspan="9" class="b-left b-right">&nbsp;</td>
            </tr>

            <!-- Footer / T&C -->
            <tr style="height: 47.7pt;">
                <td colspan="9" class="b-left b-bottom b-right no-b-top">
                    <div class="font-arial size-10">T &amp; C:</div>
                    <div class="size-10" contenteditable="true">Goods will be despatched against full payment after confirmation of credit in bank</div>
                    <div class="size-10" style="margin-top: 5px;">Declaration</div>
                    <div class="font-arial size-10" contenteditable="true">We declare that this invoice shows the actual price of the goods described and that all particulars are correct.</div>
                    <div class="font-arial size-10 text-center bold" style="margin-top: 10px;">This is a Computer-Generated Invoice, seal &amp; signature not required.</div>
                </td>
            </tr>

            <!-- Bottom Spacer -->
            <tr style="height: 24.5pt;">
                <td colspan="3" class="b-left b-bottom b-right no-b-top">&nbsp;</td>
                <td colspan="6" class="b-bottom b-right no-b-top">&nbsp;</td>
            </tr>
        </tbody>
    </table>
</div>

<script>
window.onload = function() {
    setDefaults();
    calculate();
};

function setDefaults() {
    const dateEl = document.getElementById('invoice-date');
    const invEl = document.getElementById('invoice-no');
    
    // Set Date
    const today = new Date();
    const dd = String(today.getDate()).padStart(2, '0');
    const mm = String(today.getMonth() + 1).padStart(2, '0'); // January is 0!
    const yyyy = today.getFullYear();
    const formattedDate = `${dd} - ${mm} - ${yyyy}`;
    
    // Only set if empty (preserves editing on refresh if localStorage was used, but here we just set it)
    if (!dateEl.innerText.trim()) {
        dateEl.innerText = formattedDate;
    }

    // Set Invoice Number (random example)
    if (!invEl.innerText.trim()) {
        const randomNum = Math.floor(Math.random() * 1000);
        invEl.innerText = `${yyyy}${mm}${dd}_${randomNum}`;
    }
}

function addRow() {
    // Find the add-row-container to insert before it
    const addRowContainer = document.getElementById('add-row-container');
    // Or just find the last item row
    const itemRows = document.querySelectorAll('.item-row');
    const lastRow = itemRows[itemRows.length - 1];
    const newRow = lastRow.cloneNode(true);

    // Clear values
    newRow.querySelector('.qty').innerText = '0';
    newRow.querySelector('.rate').innerText = '0';
    newRow.querySelector('.amount').innerText = '0.00';
    
    // Insert after the last item row (or before the add-row-container)
    lastRow.parentNode.insertBefore(newRow, addRowContainer);
    
    updateSL();
    calculate();
}

function deleteRow(btn) {
    const row = btn.closest('tr');
    
    // Prevent deleting the last row if it's the only one
    const itemRows = document.querySelectorAll('.item-row');
    if (itemRows.length > 1) {
        row.remove();
        updateSL();
        calculate();
    } else {
        alert("Cannot delete the last item row.");
    }
}

function updateSL() {
    const rows = document.querySelectorAll('.item-row');
    rows.forEach((row, index) => {
        row.querySelector('.sl-no').innerText = index + 1;
    });
}

function calculate() {
    const rows = document.querySelectorAll('.item-row');
    let totalTax = 0;
    let totalAmount = 0;

    rows.forEach(row => {
        const qtyText = row.querySelector('.qty').innerText;
        const rateText = row.querySelector('.rate').innerText;
        const taxPerText = row.querySelector('.tax-per').innerText;

        const qty = parseFloat(qtyText.replace(/[^\d.]/g, '')) || 0;
        const rate = parseFloat(rateText.replace(/[^\d.]/g, '')) || 0;
        const taxPer = parseFloat(taxPerText.replace(/[^\d.]/g, '')) || 0;

        const amount = qty * rate;
        
        // Update row amount
        row.querySelector('.amount').innerText = amount.toFixed(2);

        // Accumulate totals
        totalAmount += amount;
        totalTax += amount * (taxPer / 100);
    });

    const grandTotal = totalAmount + totalTax;

    document.getElementById('total-tax-amt').innerText = totalTax.toFixed(2);
    document.getElementById('grand-total').innerText = grandTotal.toFixed(2);
    
    document.getElementById('amount-words').innerText = "INR " + convertNumberToWords(Math.round(grandTotal)) + " ONLY";
}

function convertNumberToWords(amount) {
    var words = new Array();
    words[0] = '';
    words[1] = 'One';
    words[2] = 'Two';
    words[3] = 'Three';
    words[4] = 'Four';
    words[5] = 'Five';
    words[6] = 'Six';
    words[7] = 'Seven';
    words[8] = 'Eight';
    words[9] = 'Nine';
    words[10] = 'Ten';
    words[11] = 'Eleven';
    words[12] = 'Twelve';
    words[13] = 'Thirteen';
    words[14] = 'Fourteen';
    words[15] = 'Fifteen';
    words[16] = 'Sixteen';
    words[17] = 'Seventeen';
    words[18] = 'Eighteen';
    words[19] = 'Nineteen';
    words[20] = 'Twenty';
    words[30] = 'Thirty';
    words[40] = 'Forty';
    words[50] = 'Fifty';
    words[60] = 'Sixty';
    words[70] = 'Seventy';
    words[80] = 'Eighty';
    words[90] = 'Ninety';
    
    amount = amount.toString();
    var atemp = amount.split(".");
    var number = atemp[0].split(",").join("");
    var n_length = number.length;
    var words_string = "";
    
    if (n_length <= 9) {
        var n_array = new Array(0, 0, 0, 0, 0, 0, 0, 0, 0);
        var received_n_array = new Array();
        for (var i = 0; i < n_length; i++) {
            received_n_array[i] = number.substr(i, 1);
        }
        for (var i = 9 - n_length, j = 0; i < 9; i++, j++) {
            n_array[i] = received_n_array[j];
        }
        for (var i = 0, j = 1; i < 9; i++, j++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                if (n_array[i] == 1) {
                    n_array[j] = 10 + parseInt(n_array[j]);
                    n_array[i] = 0;
                }
            }
        }
        var value = "";
        for (var i = 0; i < 9; i++) {
            if (i == 0 || i == 2 || i == 4 || i == 7) {
                value = n_array[i] * 10;
            } else {
                value = n_array[i];
            }
            if (value != 0) {
                words_string += words[value] + " ";
            }
            if ((i == 1 && value != 0) || (i == 0 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Crores ";
            }
            if ((i == 3 && value != 0) || (i == 2 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Lakhs ";
            }
            if ((i == 5 && value != 0) || (i == 4 && value != 0 && n_array[i + 1] == 0)) {
                words_string += "Thousand ";
            }
            if (i == 6 && value != 0 && (n_array[i + 1] != 0 && n_array[i + 2] != 0)) {
                words_string += "Hundred and ";
            } else if (i == 6 && value != 0) {
                words_string += "Hundred ";
            }
        }
        words_string = words_string.split("  ").join(" ").toUpperCase();
    }
    return words_string;
}
</script>

</body></html>